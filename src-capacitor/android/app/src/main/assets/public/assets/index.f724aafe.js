import{q as Q,au as X,av as Y,c as I,h as y,R as A,aw as Z,K as ee,d as N,L as x,_ as B,l as c,m as S,n as p,O as o,$ as _,a3 as f,a2 as $,at as k,a4 as j,a5 as F,ax as se,ay as te,az as O,aA as oe,M as E,f as n,aB as C,Q as h,a0 as M,F as V,a1 as L,aC as ae,aD as ie,u as G,S as T,aE as q,k as z,P as w,p as g,U as b}from"./index.34ef79da.js";import{a as J,Q as le}from"./QPage.d5dd3d12.js";var K=Q({name:"QAvatar",props:{...X,fontSize:String,color:String,textColor:String,icon:String,square:Boolean,rounded:Boolean},setup(e,{slots:s}){const t=Y(e),i=I(()=>"q-avatar"+(e.color?` bg-${e.color}`:"")+(e.textColor?` text-${e.textColor} q-chip--colored`:"")+(e.square===!0?" q-avatar--square":e.rounded===!0?" rounded-borders":"")),d=I(()=>e.fontSize?{fontSize:e.fontSize}:null);return()=>{const r=e.icon!==void 0?[y(A,{name:e.icon})]:void 0;return y("div",{class:i.value,style:t.value},[y("div",{class:"q-avatar__content row flex-center overflow-hidden",style:d.value},Z(s.default,r))])}}});const re=()=>{const e=[];let s=0;for(let t=0;t<=24;t++){e[t]=[];for(let i=0;i<=23;i++)e[t].push(s),s++}return e},ne=[6,30,54,77,76,75,74,73,72,96,8,9,33,57,81,129,153,154,157,158,134,110,86,62,38,14,15,17,41,65,89,113,138,139,140,141,142,143,167,215,239,238,237,236,235,234,232,256,280,328,352,353,354,355,379,380,381,382,383,407,201,202,203,204,205,229,253,277,301,325,349,348,347,346,345,321,297,273,249,225,144,145,146,147,148,149,174,222,245,244,242,241,240,264,288,290,291,292,293,317,341,389,388,387,386,385,384,408,456,457,458,459,485,509,533,557,558,582,583,584,586,562,538,537,536,512,488,440,416,418,419,420,421,423,447,495,519,543,542,541,565,589,591,592,593,569,570,546,522,498,474,450,452,453,454,455,106,131,132,305,475,470,446,441,465,484,364,219,197,119,192,431],ce=[{door:78,entry:102,place:"escritorio"},{door:105,entry:104,place:"entrada"},{door:155,entry:179,place:"entrada"},{door:156,entry:180,place:"entrada"},{door:137,entry:161,place:"salaestar"},{door:233,entry:209,place:"salajantar"},{door:304,entry:303,place:"salajantar"},{door:451,entry:427,place:"cozinha"},{door:471,entry:472,place:"salamusica"},{door:422,entry:398,place:"salamusica"},{door:417,entry:393,place:"salamusica"},{door:464,entry:463,place:"salamusica"},{door:460,entry:461,place:"jardiminverno"},{door:365,entry:366,place:"salaojogos"},{door:289,entry:265,place:"salaojogos"},{door:198,entry:199,place:"biblioteca"},{door:243,entry:267,place:"biblioteca"}],de=["top","middle","bottom"];var R=Q({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:e=>de.includes(e)}},setup(e,{slots:s}){const t=I(()=>e.align!==void 0?{verticalAlign:e.align}:null),i=I(()=>{const d=e.outline===!0&&e.color||e.textColor;return`q-badge flex inline items-center no-wrap q-badge--${e.multiLine===!0?"multi":"single"}-line`+(e.outline===!0?" q-badge--outline":e.color!==void 0?` bg-${e.color}`:"")+(d!==void 0?` text-${d}`:"")+(e.floating===!0?" q-badge--floating":"")+(e.rounded===!0?" q-badge--rounded":"")+(e.transparent===!0?" q-badge--transparent":"")});return()=>y("div",{class:i.value,style:t.value,role:"status","aria-label":e.label},ee(s.default,e.label!==void 0?[e.label]:[]))}});const ue=N({name:"PlayerComponent",setup(){return{sessionStore:x()}},props:{player:{type:Object,required:!0},playerPosition:{type:Number,default:0},floor:{type:Number,default:0}},methods:{}}),pe=e=>(j("data-v-732dd817"),e=e(),F(),e),he=pe(()=>o("div",{class:"shadow-10",style:{width:"20px",height:"20px","border-radius":"50%",border:"1px solid #ccc"}},null,-1));function me(e,s,t,i,d,r){return e.floor===e.playerPosition?(c(),S(K,{key:0,class:"player",id:e.player.name,style:f(`background: var(--${e.player.name}-color)`)},{default:p(()=>[he,e.sessionStore.activePlayer.name===e.player.name&&e.sessionStore.game.diceValue&&!e.sessionStore.game.rollDice?(c(),S(R,{key:0,floating:"",color:"positive",class:"transparent",style:{right:"-15px",top:"-15px"}},{default:p(()=>[o("div",{class:"steps-left clue-text-shadow",style:f(`color: var(--${e.player.name}-color)`)},_(e.sessionStore.game.diceValue),5)]),_:1})):$("",!0),e.player.isNpc?(c(),S(R,{key:1,floating:""},{default:p(()=>[k(" BOT ")]),_:1})):$("",!0)]),_:1},8,["id","style"])):$("",!0)}var ye=B(ue,[["render",me],["__scopeId","data-v-732dd817"]]);const ge=N({name:"DiceDialogComponent",setup(){const e=x(),s=se(()=>oe(()=>import("./Dice.d53c294f.js"),["assets/Dice.d53c294f.js","assets/Dice.ff473fe2.css","assets/index.34ef79da.js","assets/index.908f2fc0.css"]));return{sessionStore:e,Dice:s}}});function fe(e,s,t,i,d,r){return c(),S(O,{modelValue:e.sessionStore.game.rollDice,"onUpdate:modelValue":s[0]||(s[0]=a=>e.sessionStore.game.rollDice=a),"transition-show":"scale","transition-hide":"scale",persistent:"","full-width":"",style:{"z-index":"999"}},{default:p(()=>[(c(),S(te(e.Dice)))]),_:1},8,["modelValue"])}var ve=B(ge,[["render",fe]]);const Se=N({name:"CardsDialogComponent",setup(){const e=E(),s=x();return{layoutStore:e,sessionStore:s}},computed:{myPlayer(){return this.sessionStore.game.players.find(e=>e.id===this.sessionStore.playerSelected.id)}},methods:{}}),Pe={class:"characters-container"};function _e(e,s,t,i,d,r){return c(),S(O,{modelValue:e.layoutStore.cardsDialog,"onUpdate:modelValue":s[0]||(s[0]=a=>e.layoutStore.cardsDialog=a),"transition-show":"scale","transition-hide":"scale"},{default:p(()=>[n(L,{class:"q-dialog-plugin",style:{width:"1200px !important"}},{default:p(()=>[n(C,{class:"q-dialog__title"},{default:p(()=>[k("Suas Cartas")]),_:1}),n(C,{class:"q-dialog__message"},{default:p(()=>[o("div",Pe,[(c(!0),h(V,null,M(e.myPlayer.cards,(a,l)=>(c(),h("div",{class:"character-card",key:l},[n(J,{height:"100%",width:"100%",src:`img/cards/${a.name}.jpg`},null,8,["src"])]))),128))])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var we=B(Se,[["render",_e],["__scopeId","data-v-873590e4"]]);const be=[y("circle",{cx:"15",cy:"15",r:"15"},[y("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),y("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),y("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[y("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),y("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),y("circle",{cx:"105",cy:"15",r:"15"},[y("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),y("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])];var Ce=Q({name:"QSpinnerDots",props:ae,setup(e){const{cSize:s,classes:t}=ie(e);return()=>y("svg",{class:t.value,fill:"currentColor",width:s.value,height:s.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},be)}});const ke=N({name:"PlaceDialogComponent",setup(){const e=E(),s=x(),t=G();return{layoutStore:e,sessionStore:s,firebaseStore:t}},props:{isPlayer:Boolean},data(){return{loaded:!1}},watch:{"layoutStore.placeDialog":function(e){setTimeout(()=>{this.loaded=e},1e3)}},computed:{placeNameComputed(){switch(this.sessionStore.game.place.place){case"biblioteca":return"na Biblioteca";case"cozinha":return"na Cozinha";case"entrada":return"na Entrada";case"escritorio":return"no Escrit\xF3rio";case"jardiminverno":return"Jardim de Inverno";case"salaestar":return"na Sala de Estar";case"salajantar":return"na Sala de Jantar";case"salamusica":return"na Sala de M\xFAsica";case"salaojogos":return"no Sal\xE3o de Jogos";default:return""}},indictmentReady(){return this.sessionStore.game.place.indictment&&this.sessionStore.game.place.character&&this.sessionStore.game.place.weapon}},methods:{exitPlaceDialog(){this.sessionStore.game.place={},this.sessionStore.changeActivePlayer()}}}),De=e=>(j("data-v-0595361a"),e=e(),F(),e),$e={class:"clue-text-shadow text-white shadow-21 q-pa-md"},Ve={class:"row reverse"},xe={class:"col col-12 col-sm-6 flex items-center"},qe={key:0,class:"talk-balloon full-width q-pa-sm q-mt-md column"},Me={key:0},Ne={class:"text-primary text-bold"},Be={class:"text-primary text-bold text-capitalize"},ze={class:"text-primary text-bold text-capitalize"},Oe=De(()=>o("div",{class:"col col-12 col-sm-6"},null,-1)),Ue={key:0,class:"row full-width absolute-bottom z-top q-px-md",style:{bottom:"100px"}},Ae={class:"col"},Ie={class:"full-width column flex-center"},Ee=["src"];function Qe(e,s,t,i,d,r){return c(),S(O,{modelValue:e.layoutStore.placeDialog,"onUpdate:modelValue":s[0]||(s[0]=a=>e.layoutStore.placeDialog=a),"transition-show":"scale","transition-hide":"scale","full-width":"","full-height":"",persistent:"",style:{"z-index":"999"}},{default:p(()=>[n(L,{class:"q-dialog-plugin overflow-hidden",style:f(`background: url(img/places/${e.sessionStore.game.place.place}.jpg) no-repeat;
  background-position: center; background-size: cover; width: 1200px !important;`)},{default:p(()=>[n(C,{class:"q-dialog__title q-pa-none"},{default:p(()=>[o("div",$e,_(e.placeNameComputed.replace("no ","").replace("na ","")),1)]),_:1}),n(C,{class:"q-dialog__message full-height full-width"},{default:p(()=>[o("div",Ve,[o("div",xe,[e.loaded?(c(),h("div",qe,[e.indictmentReady?(c(),h("div",Me,[k(" Eu acredito que o crime tenha ocorrido aqui "),o("span",Ne,_(e.placeNameComputed),1),k(" pelo"),o("span",Be,_(e.sessionStore.game.place.character),1),k(" com a"),o("span",ze,_(e.sessionStore.game.place.weapon),1)])):$("",!0),n(Ce,{color:"dark",size:"1rem"})])):$("",!0)]),Oe]),e.isPlayer?(c(),h("div",Ue,[o("div",Ae,[o("div",Ie,[n(T,{style:{width:"100%"},color:"primary",label:"Acusar"}),n(T,{flat:"",style:{width:"100%"},class:"q-mt-sm shadow-21",color:"primary",label:"Sair",onClick:this.exitPlaceDialog},null,8,["onClick"])])])])):$("",!0),o("div",{class:"characther-image q-pa-none",style:f(e.loaded&&"left: 20%")},[o("img",{src:`img/characters/${e.sessionStore.activePlayer.name}.png`,alt:""},null,8,Ee)],4)]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])}var je=B(ke,[["render",Qe],["__scopeId","data-v-0595361a"]]);const Fe=N({name:"ChecklistDialogComponent",setup(){const e=E(),s=x();return{layoutStore:e,sessionStore:s}},mounted(){this.sessionStore.cards.forEach(e=>{var s,t,i,d,r,a;e.category==="character"?this.characterChecklist.push({...e,checklist:(s=this.myPlayer)==null?void 0:s.checklist.some(l=>l.id===e.id),suspicious:(t=this.myPlayer)==null?void 0:t.suspicious.some(l=>l.id===e.id)}):e.category==="weapon"?this.weaponChecklist.push({...e,checklist:(i=this.myPlayer)==null?void 0:i.checklist.some(l=>l.id===e.id),suspicious:(d=this.myPlayer)==null?void 0:d.suspicious.some(l=>l.id===e.id)}):e.category==="place"&&this.placeChecklist.push({...e,checklist:(r=this.myPlayer)==null?void 0:r.checklist.some(l=>l.id===e.id),suspicious:(a=this.myPlayer)==null?void 0:a.suspicious.some(l=>l.id===e.id)})})},data(){return{characterChecklist:[],weaponChecklist:[],placeChecklist:[]}},computed:{myPlayer(){return this.sessionStore.game.players.find(e=>e.id===this.sessionStore.playerSelected.id)}},methods:{setSuspicious(e){console.log(e)}}}),Le={class:"characters-container"},Te=o("div",{class:"text-h6 text-primary"},"Personagens",-1),Re={class:"text-subtitle1"},Ge={class:"weapon-container"},Je=o("div",{class:"text-h6 text-primary"},"Armas",-1),Ke={class:"text-subtitle1"},He={class:"place-container"},We=o("div",{class:"text-h6 text-primary"},"C\xF4modos",-1),Xe={class:"text-subtitle1"};function Ye(e,s,t,i,d,r){return c(),S(O,{modelValue:e.layoutStore.checklistDialog,"onUpdate:modelValue":s[0]||(s[0]=a=>e.layoutStore.checklistDialog=a),"transition-show":"scale","transition-hide":"scale"},{default:p(()=>[n(L,{class:"q-dialog-plugin"},{default:p(()=>[n(C,{class:"q-dialog__title"},{default:p(()=>[k("Checklist")]),_:1}),n(C,{class:"q-dialog__message"},{default:p(()=>[o("div",Le,[Te,(c(!0),h(V,null,M(e.characterChecklist,(a,l)=>(c(),h("div",{class:"character-card",key:l},[o("div",{class:"full-width flex items-center justify-between q-pa-xs",style:f(l%2==0&&"background: var(--clue-light)")},[o("span",Re,_(a.name),1),o("span",null,[n(q,{disable:"",color:"teal",size:"xs",modelValue:a.checklist,"onUpdate:modelValue":m=>a.checklist=m},null,8,["modelValue","onUpdate:modelValue"]),n(q,{style:f(a.checklist&&"opacity: 0; pointer-events: none;"),"keep-color":"",color:"teal","checked-icon":"help","unchecked-icon":"help_outline",modelValue:a.suspicious,"onUpdate:modelValue":m=>a.suspicious=m},null,8,["style","modelValue","onUpdate:modelValue"])])],4)]))),128))])]),_:1}),n(C,null,{default:p(()=>[o("div",Ge,[Je,(c(!0),h(V,null,M(e.weaponChecklist,(a,l)=>(c(),h("div",{class:"weapon-card",key:l},[o("div",{class:"full-width flex items-center justify-between q-pa-xs",style:f(l%2==0&&"background: var(--clue-light)")},[o("span",Ke,_(a.name),1),o("span",null,[n(q,{disable:"",color:"teal",size:"xs",modelValue:a.checklist,"onUpdate:modelValue":m=>a.checklist=m},null,8,["modelValue","onUpdate:modelValue"]),n(q,{style:f(a.checklist&&"opacity: 0; pointer-events: none;"),"keep-color":"",color:"teal","checked-icon":"help","unchecked-icon":"help_outline",modelValue:a.suspicious,"onUpdate:modelValue":m=>a.suspicious=m},null,8,["style","modelValue","onUpdate:modelValue"])])],4)]))),128))])]),_:1}),n(C,null,{default:p(()=>[o("div",He,[We,(c(!0),h(V,null,M(e.placeChecklist,(a,l)=>(c(),h("div",{class:"place-card",key:l},[o("div",{class:"full-width flex items-center justify-between q-pa-xs",style:f(l%2==0&&"background: var(--clue-light)")},[o("span",Xe,_(a.name),1),o("span",null,[n(q,{disable:"",color:"teal",size:"xs",modelValue:a.checklist,"onUpdate:modelValue":m=>a.checklist=m},null,8,["modelValue","onUpdate:modelValue"]),n(q,{style:f(a.checklist&&"opacity: 0; pointer-events: none;"),"keep-color":"",color:"teal","checked-icon":"help","unchecked-icon":"help_outline",modelValue:a.suspicious,"onUpdate:modelValue":m=>a.suspicious=m,toogle:e.setSuspicious(a)},null,8,["style","modelValue","onUpdate:modelValue","toogle"])])],4)]))),128))])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var Ze=B(Fe,[["render",Ye]]);const es=N({name:"GamePage",setup(){const e=x(),s=E(),t=G();return{sessionStore:e,layoutStore:s,firebaseStore:t}},components:{Player:ye,DiceDialog:ve,CardsDialog:we,ChecklistDialog:Ze,PlaceDialog:je},mounted(){this.loaded=!0,this.setPlayerFocus(),this.localPlayers=Array.from(this.sessionStore.game.players),this.isNpc&&this.isOwner?setTimeout(()=>{this.rollDice()},1e3):this.isPlayer&&setTimeout(()=>{this.rollDiceBtnDialog=!0},1e3)},beforeRouteEnter(e,s,t){const i=x();!i.game.id||i.game.status!=="started"?t(!1):t()},beforeRouteLeave(e,s,t){this.sessionStore.game.id?(t(s),this.layoutStore.exitGameDialog=!0):t()},data(){return{walls:ne,doors:ce,loaded:!1,showMarkers:!1,lastDirection:"up",rollDiceBtnDialog:!1,nextDoor:0,lastPosition:0,localPlayers:[]}},watch:{"sessionStore.game":{handler:function(e){e.id?(this.firebaseStore.updateGame(e),e.diceValue||(this.localPlayers=Array.from(e.players))):this.$router.push("/home")},deep:!0},"sessionStore.game.rollDice":function(e){e||(this.setPlayerFocus(),this.isNpc&&this.isOwner&&setTimeout(()=>{this.checkNpc()},1e3))},"sessionStore.activePlayer":{handler:function(e,s){e.playerPosition!==s.playerPosition&&(this.isNpc&&!this.isOwner||!this.isPlayer)&&this.walk(),!(e.id===s.id&&e.isNpc===s.isNpc)&&(this.setPlayerFocus(),this.isNpc&&this.isOwner?setTimeout(()=>{this.rollDice()},1e3):this.isPlayer&&setTimeout(()=>{this.rollDiceBtnDialog=!0},1e3))},deep:!0},"sessionStore.game.place.place":{handler:function(e){e?this.layoutStore.placeDialog=!0:this.layoutStore.placeDialog=!1}}},computed:{isOwner(){var e;return this.sessionStore.game.ownerId===((e=this.sessionStore.user)==null?void 0:e.id)},isPlayer(){var e,s;return((e=this.sessionStore.activePlayer)==null?void 0:e.id)===((s=this.sessionStore.playerSelected)==null?void 0:s.id)},isNpc(){var e;return(e=this.sessionStore.activePlayer)==null?void 0:e.isNpc},rollDiceBtnDialogComputed:{get(){return this.isPlayer&&!this.sessionStore.game.diceValue&&!this.sessionStore.game.rollDice},set(){this.rollDice()}}},methods:{padMovePlayer(e,s){console.log("padMovePlayer",e);let t=document.querySelector(`#${this.sessionStore.activePlayer.name}`);if(!t||t.classList.contains("player-moving"))return;const i=parseInt(getComputedStyle(t).top.replace("px","")),d=parseInt(getComputedStyle(t).left.replace("px",""));if(e==="up"){const r=this.sessionStore.activePlayer.playerPosition-(s?0:24);if(!this.checkObstacle(r))return!1;t.classList.add("player-moving"),t.style.top=i-50+"px",this.lastDirection=="up"&&this.setPlayerFocus("y"),setTimeout(()=>{s?this.localPlayers=Array.from(this.sessionStore.game.players):this.setPlayerPosition(t,r)},300)}else if(e==="right"){const r=this.sessionStore.activePlayer.playerPosition+(s?0:1);if(!this.checkObstacle(r))return!1;t.classList.add("player-moving"),t.style.left=d+50+"px",this.lastDirection=="right"&&this.setPlayerFocus("x"),setTimeout(()=>{s?this.localPlayers=Array.from(this.sessionStore.game.players):this.setPlayerPosition(t,r)},300)}else if(e==="down"){const r=this.sessionStore.activePlayer.playerPosition+(s?0:24);if(!this.checkObstacle(r))return!1;t.classList.add("player-moving"),t.style.top=i+50+"px",this.lastDirection=="down"&&this.setPlayerFocus("y"),setTimeout(()=>{s?this.localPlayers=Array.from(this.sessionStore.game.players):this.setPlayerPosition(t,r)},300)}else if(e==="left"){const r=this.sessionStore.activePlayer.playerPosition-(s?0:1);if(!this.checkObstacle(r))return!1;t.classList.add("player-moving"),t.style.left=d-50+"px",this.lastDirection=="left"&&this.setPlayerFocus("x"),setTimeout(()=>{s?this.localPlayers=Array.from(this.sessionStore.game.players):this.setPlayerPosition(t,r)},300)}return this.lastDirection=e,!0},checkObstacle(e){console.log("checkObstacle",e);const s=this.doors.find(t=>t.door==e);return s&&this.sessionStore.activePlayer.playerPosition!==s.entry?!1:!(e<0||e>600||this.walls.includes(e))},setPlayerPosition(e,s){e.classList.remove("player-moving"),console.log("nextFloor",s),this.sessionStore.activePlayer.playerPosition=s,this.sessionStore.game.diceValue--,this.sessionStore.game.diceValue&&this.isNpc&&this.isOwner&&setTimeout(()=>{this.checkNpc()},1e3);const t=this.doors.find(i=>i.door==this.sessionStore.activePlayer.playerPosition);t?this.enterPlace(t):this.sessionStore.game.diceValue||this.setNextPlayer()},enterPlace(e){this.sessionStore.game.diceValue=0,this.sessionStore.game.place.place=e.place,console.log(`Entrou no ${e.place}`)},setNextPlayer(){this.sessionStore.changeActivePlayer()},rollDice(){this.rollDiceBtnDialog=!1,this.sessionStore.game.diceValue=12,this.sessionStore.game.rollDice=!0},walk(){console.log("walk");let e;const s=this.localPlayers.find(t=>t.id===this.sessionStore.activePlayer.id);if(s){const t=s.playerPosition;console.log("oldPosition",t);const i=this.sessionStore.activePlayer.playerPosition;console.log("newPosition",i),t-24==i?e="up":t+1==i?e="right":t+24==i?e="down":t-1==i&&(e="left"),e&&(this.padMovePlayer(e,!0),console.log("walk",e))}},checkNpc(){if(!this.isNpc||this.$route.name!=="game"||!this.sessionStore.game.diceValue){this.lastPosition=0;return}const e=this.sessionStore.activePlayer.playerPosition;let s=this.sessionStore.activePlayer.playerPosition-24,t=this.sessionStore.activePlayer.playerPosition+1,i=this.sessionStore.activePlayer.playerPosition+24,d=this.sessionStore.activePlayer.playerPosition-1;function r(u,P){return Math.sqrt((P.col-u.col)*(P.col-u.col)+(P.row-u.row)*(P.row-u.row))}const a=this.doors.map(u=>({...this.getCoord(u.door),...u,distance:r(this.getCoord(e),this.getCoord(u.door))}));let l=null;a.forEach(u=>{(!l||u.distance<l.distance)&&(l=u)});const m=[{movement:"up",position:s,...this.getCoord(s),distance:r(this.getCoord(s),this.getCoord(l.door))},{movement:"right",position:t,...this.getCoord(t),distance:r(this.getCoord(t),this.getCoord(l.door))},{movement:"down",position:i,...this.getCoord(i),distance:r(this.getCoord(i),this.getCoord(l.door))},{movement:"left",position:d,...this.getCoord(d),distance:r(this.getCoord(d),this.getCoord(l.door))}];let D=null;console.log("coordDoors",a),console.log("coordDirections",m);const U=a.find(u=>u.door===e);U?D=m.find(P=>P.position===U.entry):m.forEach(u=>{this.checkObstacle(u.position)&&u.position!==this.lastPosition&&(!D||u.distance<D.distance)&&(D=u)}),this.lastPosition=e,this.padMovePlayer(D.movement)===!1&&this.checkNpc()},getCoord(e){const s=re();let t,i;return s.forEach(d=>{d.forEach(r=>{r==e&&(t=s.indexOf(d),i=d.indexOf(r))})}),{col:i,row:t}},getPlayerPosition(e){var s;return this.isPlayer?e.playerPosition:(s=this.localPlayers.find(t=>t.id===e.id))==null?void 0:s.playerPosition},setPlayerFocus(e){setTimeout(()=>{let s=document.querySelector(`#${this.sessionStore.activePlayer.name}`);if(!s)return;const t=s.getBoundingClientRect(),i=this.$q.screen.width,d=this.$q.screen.height;e==="x"?window.scrollBy(t.x-i/2,0):e==="y"?window.scrollBy(0,t.y-d/2):window.scrollBy(t.x-i/2,t.y-d/2)})}}}),H=e=>(j("data-v-7ba40eb5"),e=e(),F(),e),ss={class:"options-bar-item"},ts={class:"options-bar-item"},os={class:"board"},as=H(()=>o("br",null,null,-1)),is={class:"places"},ls={class:"controls"},rs={key:0,class:"control-pad"},ns={class:"row full-width"},cs={class:"row full-width",style:{width:"110px"}},ds={class:"d-flex column flex-center transparent"},us=H(()=>o("div",{class:"text-white text-h4 clue-text-shadow"},"Role os Dados",-1));function ps(e,s,t,i,d,r){const a=z("Player"),l=z("DiceDialog"),m=z("CardsDialog"),D=z("ChecklistDialog"),U=z("PlaceDialog");return c(),h(V,null,[n(le,{class:"border-container"},{default:p(()=>[o("div",{class:"options-bar fixed-top flex justify-end z-max",style:f(e.loaded&&"top: 0;")},[w((c(),h("div",ss,[n(A,{name:"checklist_rtl",size:"24px",color:"primary",onClick:s[0]||(s[0]=v=>e.layoutStore.checklistDialog=!0)})])),[[b]]),w((c(),h("div",{class:"options-bar-item",onClick:s[1]||(s[1]=v=>e.layoutStore.cardsDialog=!0)},[n(A,{name:"style",size:"24px",color:"primary"})])),[[b]]),w((c(),h("div",ts,[n(A,{name:"logout",size:"24px",color:"primary",onClick:s[2]||(s[2]=v=>e.$router.push("/home"))})])),[[b]])],4),o("div",os,[(c(),h(V,null,M(600,(v,u)=>o("div",{class:g(["floor",{"floor-markers":e.showMarkers}]),key:u},[o("span",{class:g({hidden:!e.showMarkers})},[k(" Floor "),as,k(" "+_(u),1)],2),(c(!0),h(V,null,M(e.sessionStore.game.players,(P,W)=>(c(),S(a,{key:W,player:P,floor:u,playerPosition:e.getPlayerPosition(P)},null,8,["player","floor","playerPosition"]))),128))],2)),64)),o("div",is,[o("div",{class:g(["place stairway solid",{hidden:!e.showMarkers}])}," Stairway ",2),o("div",{class:g(["place study solid",{hidden:!e.showMarkers}])}," Study ",2),o("div",{class:g(["place hall solid",{hidden:!e.showMarkers}])}," Hall ",2),o("div",{class:g(["place lounge solid",{hidden:!e.showMarkers}])}," Lounge ",2),o("div",{class:g(["place library solid",{hidden:!e.showMarkers}])}," Library ",2),o("div",{class:g(["place dinning solid",{hidden:!e.showMarkers}])}," Dinning Room ",2),o("div",{class:g(["place billiard solid",{hidden:!e.showMarkers}])}," Billiard Room ",2),o("div",{class:g(["place conservatory solid",{hidden:!e.showMarkers}])}," Conservatory ",2),o("div",{class:g(["place ballroom solid",{hidden:!e.showMarkers}])}," Ball Room ",2),o("div",{class:g(["place kitchen solid",{hidden:!e.showMarkers}])}," Kitchen ",2)]),o("div",ls,[e.isPlayer&&e.sessionStore.game.diceValue?(c(),h("div",rs,[o("div",ns,[w(o("div",{class:"col pad",id:"up",style:{"border-left":"none",margin:"4px","margin-left":"0"},onClick:s[3]||(s[3]=v=>e.padMovePlayer("up"))},null,512),[[b]]),w(o("div",{class:"col pad",id:"right",style:{"border-right":"none",margin:"4px","margin-right":"0"},onClick:s[4]||(s[4]=v=>e.padMovePlayer("right"))},null,512),[[b]])]),o("div",cs,[w(o("div",{class:"col pad",id:"left",style:{"border-left":"none",margin:"4px","margin-left":"0"},onClick:s[5]||(s[5]=v=>e.padMovePlayer("left"))},null,512),[[b]]),w(o("div",{class:"col pad",id:"down",style:{"border-right":"none",margin:"4px","margin-right":"0"},onClick:s[6]||(s[6]=v=>e.padMovePlayer("down"))},null,512),[[b]])])])):$("",!0)]),n(O,{modelValue:e.rollDiceBtnDialog,"onUpdate:modelValue":s[7]||(s[7]=v=>e.rollDiceBtnDialog=v),"transition-show":"scale","transition-hide":"scale",persistent:"","full-width":"",style:{"z-index":"999"}},{default:p(()=>[o("div",ds,[us,w((c(),S(K,{onClick:e.rollDice,size:"200px",class:"cursor-pointer relative-position"},{default:p(()=>[n(J,{class:"clue-text-shadow",src:"img/dices.png"})]),_:1},8,["onClick"])),[[b]])])]),_:1},8,["modelValue"])])]),_:1}),n(l),n(m),n(D),n(U,{isPlayer:e.isPlayer},null,8,["isPlayer"])],64)}var ys=B(es,[["render",ps],["__scopeId","data-v-7ba40eb5"]]);export{ys as default};
